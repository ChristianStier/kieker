apply plugin: 'war'

sourceSets {
  main { 
    java { 
      srcDir 'livedemo-source/src' 
    } 
  }
}

webAppDirName = 'livedemo-source/WebContent'

dependencies {
	compile fileTree('../../dist') {
		include 'kieker-*_emf.jar'
	}
  compile fileTree('livedemo-source/lib') {
    include '*.jar'
  }
}

compileJava.dependsOn rootProject.emfJar

task unwar(type: Copy) {
  from war
  into 'jetty/webapps'
  rename '(.*).war', 'livedemo.war'
}

task copyAspectJ(type: Copy, dependsOn: rootProject.aspectJJar) {
  from ('../../dist') {
		include 'kieker-*_aspectj.jar'
	}
  into 'jetty/webapps/jpetstore/WEB-INF/lib'
}

task copySigar(type: Copy) {
  from ('../../lib/sigar') {
		include '*'
	}
  into 'jetty/webapps/jpetstore/WEB-INF/lib'
}

task buildExample(dependsOn: [war, unwar, copyAspectJ, copySigar]) << {
}