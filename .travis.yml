sudo: required

language: bash

env:
  global:
   #- KIEKER_GIT="http://build.se.informatik.uni-kiel.de/gitlab/kieker/kieker.git"
    - KIEKER_GIT="https://github.com/kieker-monitoring/kieker.git"
    - GRADLE_TARGET="build"
    - DOCKER_IMAGE_TAG=openjdk6  
  matrix:
    - GRADLE_EXCLUDES=""
    - GRADLE_EXCLUDES="-x test"

services:
  - docker

before_install:
  - docker pull kieker/kieker-build:$DOCKER_IMAGE_TAG

script:
  - docker run kieker/kieker-build:$DOCKER_IMAGE_TAG /bin/bash -c "git clone ${KIEKER_GIT} kieker && \
cd kieker/ && \
if ! [ "$TRAVIS_PULL_REQUEST" = false ]; then \
  git fetch origin pull/${TRAVIS_PULL_REQUEST}/head && \
  git checkout -b travis FETCH_HEAD; \
fi && \
./gradlew ${GRADLE_TARGET} ${GRADLE_EXCLUDES}"

